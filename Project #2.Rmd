---
title: "Energy Drinks And Pulse Rate"
author: "Kaili Saffran"
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
require(mosaic)
library(data.table)

rm(list=ls())
```

#Introduction

In this study, we want to answer the question *Does the type of energy drink consumed impact pulse rate?*. I am interested in studying this hypothesis because energy drinks are known to increase heart rate, but I am interested in if different types of energy drinks do not effect or effect heart rate more than others. Sugar-free and caffeine-free energy drinks may have a different impact on heart rate as opposed to an energy drink that contains both or neither of the two. 

#Methodology

The purpose of this study was to determine if the type of energy drink consumed affects heart rate. I predict that the type of energy drink consumed will have a different impact on heart rate as opposed to other types of energy drinks. This is because energy drinks with no sugar or no caffeine should not increase heart rate as much as an energy drink with sugar and caffeine. 

###Measurement

1. Population of interest:  Islanders
2. Response Variable(s):  Pulse Rate (Level of Measurement: Beats per minute)
3. Independent Variable(s):  The type of energy drink the subject consumed (Regular, Caffeine-free, Sugar-free, Caffeine-Free Sugar-Free)
4. Extraneous variables that might influence the results & how we will control for this: I did not control for gender or age. However, this should not make much of difference. 

###Design

This experiment follows the one-way anova method, as show below  

            Pre-test  Treatment     Post-test
-------     -------- -----------   -----------
     R                   X1             O1
                         X2             O2
                         X3             O3
                         X4             O4
-------     -------- -----------   -----------
This design controls for the following threats to validity: Selection Bias, Testing Effect. Since we randomized the sample and there is no pre-test, there is no selection bias or testing effect.  

We could not control for these threats to validity: History and Subject Characteristics. The subject may be exposed to doing something else that could increase heart rate, such as exercise, stress, etc. Stress or anxiety would be a subject characteristic that cannot be controlled for.    

###Sample/Randomization Method

I performed a simplified random sample by first randomly choosing one city in the Islands of my choice. I chose the city Nelson. I took a random sample of the houses in Nelson for 4 groups (A-D). Each group will represent one of the independent variables. I will start with group A and go through each house until I get to group D. If there are any houses repeated in the process, subjects that are unwilling to participate, or vacant homes, I will move on to the next highest numbered house or move on to the next Islander that lives in that house. There is no control or treatment group since all subjects for each group will participate in the same post test after receiving the treatment they are assigned. 

```{r}
#Group A (ED)
set.seed(10)
sample(1:470,15,replace=F)

#Group B (CF)
set.seed(20)
sample(1:470,15,replace=F)

#Group C (CFSF)
set.seed(30)
sample(1:470,15,replace=F)

#Group D (SF)
set.seed(40)
sample(1:470,15,replace=F)
```

#Data 
```{r}
getwd()
setwd("/Users/kailisaffran/Documents/Spring 2019/Experimental Design")

df <- fread("/Users/kailisaffran/Documents/Spring 2019/Experimental Design/Project 2 data.csv")
```

### Descriptive Statistics
```{r}
favstats(~Pulse | Group, data=df)
boxplot(Pulse~Group, data=df)
histogram(~Pulse, data=df)
```
By looking at some numerical analysis of the data, we can already see that the average pulse rate for the groups that consumed the caffeine-free and regular energy drink is much higher. The average pulse rate for the Islanders that consumed the caffeine-free, sugar-free energy drink is far lower. Graphical analysis of the data shows this difference through the boxplot. The median for the caffeine-free and regular energy drink appear almost the same. Whereas, the median for the caffeine-free, sugar-free and sugar-free energy drink are similar. The boxplot also seems to show that there is equal variance within all the groups. The histogram shows that the entire set of data for pulse rate seems to be pretty normally distributed.

#Results

Hypothesis:

Let $mu_1$ = the average pulse rate for Islanders who drank an energy drink.   
Let $mu_2$ = the average pulse rate for Islanders who drank a caffeine-free energy drink.   
Let $mu_3$ = the average pulse rate for Islanders who drank a caffeine-free, sugar-free energy drink.    
Let $mu_4$ = the average pulse rate for Islanders who drank a sugar-free energy drink.

H0:  $\mu_1 = \mu_2 = \mu_3 = \mu_4$  
Ha:  At least one of these types of energy drinks has a different average pulse rate effect on the Islanders compared to the others.

###Test of Normality
Ho: The response variable, pulse, is normally distributed
Ha: The response variable, pulse, is not normally distributed
```{r}
histogram(~Pulse, data=df, width=2, fit="normal")
shapiro.test(df$Pulse)
```
The test of normality produces a p-value of 0.72, preventing us from rejecting the null hypothesis that the pulse data is normally distributed. The histogram shows that the data for the most part follows the shape of a bell curve.

###Test of Homogeneity
Ho: Variance is the same in all groups
Ha: Variance is not the same in all groups
```{r}
bwplot(Group~Pulse, data=df)
bartlett.test(df$Pulse ~ df$Group)
```
The test of homogeneity produces a p-value of 0.32, preventing us from rejecting the null hypothesis that the variance is the same in all groups. The boxplot supports fairly equal variances as well.

Both conditions of normality and homogeneity are satisfied with this data. Therefore, we can perform an AOV F test to determine if the supposed different average pulse rates is significant between the groups.

##ANOVA Test
```{r}
m <- aov(Pulse~Group, data=df)
anova(m)
```
The AOV F test produces a p-value of 0.0006. Therefore, the null hypothesis can be rejected that all average pulse rates for each group are the same. We can conclude that at least one group has a different average pulse rate than the others. Further, since we rejected the null hypothesis, a post-hoc test can be conducted to determine which groups have significantly different pulse rate averages.

```{r}
##Effect Size
SSB=1293.5
SST=1293.5+3611.5
(eta=SSB/SST)
```
The effect size tells us that the variation between the groups explains about 26% of the variance of all the groups pulses combined.

##Post-hoc Analysis
```{r}
library(lmPerm)
n <- aovp(Pulse~as.factor(Group), data=df)
summary(n)
(t<-TukeyHSD(n))
mplot(t, beside=TRUE)
```
Through using Tukey's method, using a significance level of 0.05, there are significant differences between the average pulse rate between those who consumed a caffeine-free, sugar-free energy drink vs. a caffeine-free energy drink and those who consumed a regular energy drink vs. a caffeine-free, sugar-free energy drink. 

#Reflection 
Through performing this one-way anova, we have produced statistically significant results and concluded that the type of energy drink consumed does have an effect on pulse rate. Based on the numerical analysis performed, it would be interesting to study further whether sugar or caffeine has a greater effect on pulse rate. Based on the numerical analysis conducted it appears sugar is more likely to increase pulse rate than caffeine.
